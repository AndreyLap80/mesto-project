(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{f:()=>z});var t=document.querySelector(".popup_opened_image"),n=document.querySelector(".popup_opened_profile"),o=document.querySelector(".popup__image"),r=document.querySelector(".popup__text");function c(e,t){e&&(t.textContent="Сохранение...")}function i(e,t){e.classList.add("popup_opened"),document.querySelector(".form_card-delete"),document.addEventListener("mousedown",a),document.addEventListener("keydown",u)}function a(e){e.target.closest(".popup__container,.popup__container-image")||l(e.target.closest(".popup"))}function u(e){if("Escape"===e.key){var t=document.querySelector(".popup.popup_opened");t&&l(t)}}function l(e){e.classList.remove("popup_opened"),document.removeEventListener("mousedown",a),document.removeEventListener("keydown",u)}var s=document.querySelector(".form_card"),d=document.querySelector(".avatar__form"),m=(document.querySelector(".form_card-delete"),document.querySelector(".form__input_popup_link-avatar")),p=document.querySelector(".form__input_popup_designation"),_=document.querySelector(".form__input_popup_link-picture"),f=document.querySelector(".profile__edit-button"),v=document.querySelector(".profile__avatar-edit-button"),y=document.querySelector(".popup__form"),h=document.querySelector(".form__input_popup_name"),S=document.querySelector(".form__input_popup_about"),k=document.querySelector(".profile__add-button"),q=document.querySelectorAll(".form__button_close"),b=document.querySelector(".popup_opened_card-delete"),E=document.querySelector(".popup_opened_card"),L=document.querySelector(".popup_opened_avatar"),g=document.querySelector(".profile__avatar"),C=document.querySelector(".profile__name"),x=document.querySelector(".profile__about-me"),w=document.querySelector(".elements"),A=document.querySelector("#elements-template").content;function O(e,n,c){var a=e.name,u=e.link,l=e.likes,s=e.owner,d=e._id,m=A.cloneNode(!0),p=m.querySelector(".elements__mask-group"),_=m.querySelector(".elements__delete"),f=m.querySelector(".elements__like"),v=m.querySelector(".elements__like-counter"),y=m.querySelector(".elements__rectangle");return m.querySelector(".elements__text").textContent=a,y.id=d,_.id=d,f.id=d,p.src=u,p.alt=a,v.textContent=l.length,p.addEventListener("click",(function(e){!function(e){var n=e.name,c=e.link;o.src=c,r.textContent=n,o.alt=n,i(t)}({name:a,link:u})})),_.addEventListener("click",(function(e){z(e.target.id)})),f.addEventListener("click",(function(e){n(e.target.id,f,v),f.classList.toggle("elements__like_active")})),l.forEach((function(e){var t=e._id;c.id._id===t?f.classList.add("elements__like_active"):f.classList.remove("elements__like_active")})),s===c.id._id&&(_.style.display="block"),m}var P=function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.removeAttribute("disabled"),t.classList.remove(n.inactiveButtonClass)):(t.setAttribute("disabled",!0),t.classList.add(n.inactiveButtonClass))},T="https://nomoreparties.co/v1/plus-cohort-14",B={Authorization:"5a9cae72-b390-4257-b620-5f35d3f837bc","Content-Type":"application/json"};function D(e){return e.ok?e.json():Promise.reject("Что-то пошло не так: ".concat(e.status))}var j,N={},J={};function H(e,t,n){var o,r;t.classList.contains("elements__like_active")?(r=e,fetch("".concat(T,"/cards/likes/").concat(r),{method:"DELETE",headers:B}).then(D)).then((function(e){n.textContent=e.likes.length})).catch((function(e){console.log(e)})):t.classList.contains("elements__like_active")||(o=e,fetch("".concat(T,"/cards/likes/").concat(o),{method:"PUT",headers:B}).then(D)).then((function(e){n.textContent=e.likes.length})).catch((function(e){console.log(e)}))}function z(e){var t;(t=e,fetch("".concat(T,"/cards/").concat(t),{method:"DELETE",headers:B}).then(D)).then((function(){document.getElementById(e).remove(),l(b)})).catch((function(e){console.log(e)}))}fetch("".concat(T,"/users/me"),{headers:B}).then(D).then((function(e){g.src=e.avatar,C.textContent=e.name,x.textContent=e.about,N.id=e})).catch((function(e){console.log(e)})),fetch("".concat(T,"/cards"),{headers:B}).then(D).then((function(e){return e.forEach((function(t){var n;n=O({name:t.name,link:t.link,likes:t.likes,owner:t.owner._id,_id:t._id},H,N),w.prepend(n),J.info=e}))})).catch((function(e){console.log(e)})),s.addEventListener("submit",(function(e){var t,n=this;e.preventDefault(),c(!0,e.submitter),(t={name:p.value,link:_.value},fetch("".concat(T,"/cards"),{method:"POST",body:JSON.stringify({name:t.name,link:t.link}),headers:B}).then(D)).then((function(e){!function(e,t,n){w.prepend(O(e,t,n)),l(E)}({name:e.name,link:e.link,likes:e.likes,owner:e.owner._id,_id:e._id},H,N),n.reset()})).catch((function(e){console.log(e)})).finally((function(){c(!1)}))}),P),d.addEventListener("submit",(function(e){var t,n=this;e.preventDefault(),c(!0,e.submitter),(t=m.value,fetch("".concat(T,"/users/me/avatar"),{method:"PATCH",body:JSON.stringify({avatar:t}),headers:B}).then(D)).then((function(e){g.src=e.avatar,l(L),n.reset()})).catch((function(e){console.log(e)})).finally((function(){c(!1)}))}),P),f.addEventListener("click",(function(){h.value=C.textContent,S.value=x.textContent,i(n)})),k.addEventListener("click",(function(){return i(E)})),v.addEventListener("click",(function(){return i(L)})),q.forEach((function(e){e.addEventListener("click",(function(e){l(e.target.closest(".popup"))}))})),y.addEventListener("submit",(function(e){var t;e.preventDefault(),c(!0,e.submitter),(t={name:h.value,about:S.value},fetch("".concat(T,"/users/me"),{method:"PATCH",body:JSON.stringify({name:t.name,about:t.about}),headers:B}).then(D)).then((function(e){C.textContent=e.name,x.textContent=e.about,l(n)})).catch((function(e){console.log(e)})).finally((function(){c(!1)}))})),j={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__button_popup_save",inactiveButtonClass:"form__button_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active"},document.querySelectorAll(j.formSelector).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);P(n,o,t),n.forEach((function(r){r.addEventListener("input",(function(){!function(e,t,n){t.validity.valid?function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),o.classList.remove(n.errorClass),o.textContent=""}(e,t,n):function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add(o.inputErrorClass),r.textContent=n,r.classList.add(o.errorClass)}(e,t,t.validationMessage,n)}(e,r,t),P(n,o,t)}))}))}(e,j)}))})();